<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
        "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN"
        "http://struts.apache.org/dtds/struts-2.3.dtd">

<struts>
    <constant name="struts.multipart.maxSize" value="1000000" />

    <package name="default" namespace="/" extends="json-default">
        <interceptors>
            <interceptor name="authentication"
                         class="com.shooting_stars.project.interceptor.AuthenticationInterceptor" />
            <interceptor-stack name="privateStack">
                <interceptor-ref name="authentication" />
                <interceptor-ref name="defaultStack" />
            </interceptor-stack>
        </interceptors>
        <global-results>
            <result name="error">
                /jsp/error/error.jsp
            </result>
            <result name="login">
                /index.jsp
            </result>
        </global-results>
        <action name="getUnreadMessagesAmount" class="com.shooting_stars.project.command.GetUnreadMessagesAmountCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json" />
        </action>
        <action name="login" class="com.shooting_stars.project.command.LoginCommand">
            <result name="success" type="redirectAction">
                userPage
            </result>
            <result name="login_failed">
                /index.jsp
            </result>
            <result name="input">
                /index.jsp
            </result>
        </action>
        <action name="logout" class="com.shooting_stars.project.command.LogoutCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /index.jsp
            </result>
        </action>
        <action name="changeLocale" class="com.shooting_stars.project.command.ChangeLocaleCommand">
            <result name="success">
                /index.jsp
            </result>
        </action>
        <action name="userPage" class="com.shooting_stars.project.command.FormUserPageCommand">
            <interceptor-ref name="privateStack"/>
            <result name="user">
                /jsp/authorised/profile.jsp
            </result>
            <result name="other_user">
                /jsp/authorised/userPage.jsp
            </result>
        </action>

        <action name="registration" class="com.shooting_stars.project.command.PreparingRegistrationCommand">
            <result name="success" type="redirectAction">
                userPage
            </result>
            <result name="step1">
                /jsp/guest/registration1.jsp
            </result>
            <result name="step2">
                /jsp/guest/registration2.jsp
            </result>
            <result name="step3">
                /jsp/guest/registration3.jsp
            </result>
        </action>

        <action name="changePhoto" class="com.shooting_stars.project.command.ChangePhotoCommand">
            <interceptor-ref name="privateStack"/>
            <interceptor-ref name="fileUpload">
                <param name="allowedTypes">image/jpeg, image/png, image/jpg</param>
                <param name="maximumSize">5000000</param>
            </interceptor-ref>
            <interceptor-ref name="defaultStack"/>
            <interceptor-ref name="validation"/>
            <interceptor-ref name="workflow"/>
             <result name="success" type="redirectAction">
                 userPage
             </result>
            <result name="input">
                /jsp/authorised/changePhoto.jsp
            </result>
        </action>

        <action name="saveWishes" class="com.shooting_stars.project.command.SaveWishesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction">
                userPage
            </result>
        </action>
        <action name="deleteWish" class="com.shooting_stars.project.command.DeleteWishCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction">
                userPage
            </result>
        </action>
        <action name="acceptApplication" class="com.shooting_stars.project.command.AcceptApplicationCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction">
                userPage
            </result>
        </action>
        <action name="cancelMakingWish" class="com.shooting_stars.project.command.CancelMakingWishCommand">
            <interceptor-ref name="privateStack"/>
            <result name="userPage" type="redirectAction" >
                userPage?userId=${userId}
            </result>
            <result name="profile" type="redirectAction" >
                userPage
            </result>
            <result name="myWishesPage">
                /jsp/authorised/myWishes.jsp?userId=${sessionUserId}
            </result>
        </action>
        <action name="cancelApplication" class="com.shooting_stars.project.command.CancelApplicationCommand">
            <interceptor-ref name="privateStack"/>
            <result name="userPage" type="redirectAction" >
                userPage?userId=${userId}
            </result>
            <result name="profile" type="redirectAction" >
                userPage
            </result>
            <result name="myWishesPage">
                /jsp/authorised/myWishes.jsp?userId=${sessionUserId}
            </result>
        </action>
        <action name="makeApplication" class="com.shooting_stars.project.command.MakeApplicationCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction" >
                userPage?userId=${userId}
            </result>
        </action>
        <action name="wishMade" class="com.shooting_stars.project.command.MarkWishMadeCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction" >
                userPage
            </result>
        </action>
        <action name="myFulfilledWishes" class="com.shooting_stars.project.command.GetUsersWishesFulfilledCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/myFulfilledWishes.jsp
            </result>
        </action>
        <action name="updateFulfilledWishes" class="com.shooting_stars.project.command.GetUsersWishesFulfilledCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json" />
        </action>
        <action name="fulfilledWishes" class="com.shooting_stars.project.command.GetWishesUserParticipatesInCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/myWishes.jsp
            </result>
        </action>
        <action name="updateMyWishes" class="com.shooting_stars.project.command.GetWishesUserParticipatesInCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json" />
        </action>
        <action name="editUserInfo" class="com.shooting_stars.project.command.EditUserInfoCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/infoEditor.jsp
            </result>
        </action>
        <action name="saveEditedUserInfo" class="com.shooting_stars.project.command.SaveEditedUserInfoCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction" >
                userPage
            </result>
            <result name="input">
                /jsp/authorised/infoEditor.jsp
            </result>
        </action>
        <action name="editUserAbilities" class="com.shooting_stars.project.command.EditUserAbilitiesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/abilitiesEditor.jsp
            </result>
        </action>
        <action name="saveEditedUserAbilities" class="com.shooting_stars.project.command.SaveEditedUserAbilitiesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction" >
                userPage
            </result>
        </action>
        <action name="chats" class="com.shooting_stars.project.command.GetUserChatsCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success"  >
                /jsp/authorised/chats.jsp
            </result>
        </action>


        <action name="updateChats" class="com.shooting_stars.project.command.GetUserChatsCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json"/>
        </action>

        <action name="sendMessage" class="com.shooting_stars.project.command.SendMessageCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction">
                getMessages?chatId=${chatId}
            </result>
            <result name="input">
                getMessages?chatId=${chatId}
            </result>
        </action>

        <action name="getMessages" class="com.shooting_stars.project.command.GetMessagesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/messages.jsp
            </result>
            <result name="invalid_chat" type="redirectAction">
                chats
            </result>
        </action>
        <action name="toChat" class="com.shooting_stars.project.command.GoToChatCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success" type="redirectAction">
                getMessages?chatId=${chatId}
            </result>
        </action>
        <action name="usersSearch" class="com.shooting_stars.project.command.UsersSearchCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/search.jsp
            </result>
            <result name="input">
                /jsp/authorised/search.jsp
            </result>
        </action>
        <action name="changePassword" class="com.shooting_stars.project.command.ChangePasswordCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/settings.jsp
            </result>
            <result name="input">
                /jsp/authorised/settings.jsp
            </result>
        </action>
        <action name="newMessages" class="com.shooting_stars.project.command.GetUnreadMessagesCommand">

            <interceptor-ref name="privateStack"/>
            <result type="json"/>
        </action>
        <action name="updateWishes" class="com.shooting_stars.project.command.UpdateWishesCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json"/>
        </action>
        <action name="getEmail" class="com.shooting_stars.project.command.GetEmailCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json"/>
        </action>
        <action name="changeEmail" class="com.shooting_stars.project.command.ChangeEmailCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/settings.jsp
            </result>
            <result name="input">
                /jsp/authorised/settings.jsp
            </result>
        </action>
        <action name="wishesSearch" class="com.shooting_stars.project.command.FindWishesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/wishesSearch.jsp
            </result>
        </action>
        <action name="recentWishes" class="com.shooting_stars.project.command.FindRecentWishesCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/wishesSearch.jsp
            </result>
        </action>
        <action name="birthdayMen" class="com.shooting_stars.project.command.GetBirthdayMenCommand">
            <interceptor-ref name="privateStack"/>
            <result name="success">
                /jsp/authorised/search.jsp
            </result>
        </action>
        <action name="updateVisitTime" class="com.shooting_stars.project.command.UpdateVisitTimeCommand">
            <interceptor-ref name="privateStack"/>
            <result type="json"/>
        </action>
</package>

</struts>